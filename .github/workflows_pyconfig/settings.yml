#############################################################################
# CI infrastructure settings
#############################################################################
ci:
  # Docker image with administration tools
  admin_image: ghcr.io/mentalsmash/ref-project-debdocker-admin:latest
  # Base Docker image for tester images used by PR tests 
  ci_tester_repo: ghcr.io/mentalsmash/ref-project-debdocker-ci-tester
  # Local Docker image generated by all CI tests
  local_tester_image: mentalsmash/ref-project-debdocker-test-runner:latest
  # Directory where test artifacts will be generated by default
  local_tester_results: test-results
  # Runner labels used by each architecture
  # Represented as JSON string
  runners:
    linux/arm64: [self-hosted, linux, arm64]
    linux/amd64: ubuntu-latest

#############################################################################
# Debian packaging settings
#############################################################################
debian:
  artifacts_prefix: ref-project-debdocker-deb-
  base_images:
  - ubuntu:22.04
  builder_repo: ghcr.io/mentalsmash/ref-project-debdocker-debian-builder
  dist_dir: debian-dist
  build_architectures:
  - amd64
  - arm64

#############################################################################
# Pull Request settings
#############################################################################
pull_request:
  validation:
    basic:
      base_images:
      - ubuntu:22.04
      build_platforms:
      - linux/amd64
    full:
      base_images:
      - ubuntu:22.04
      build_platforms:
      - linux/arm64
    deb:
      base_images:
      - ubuntu:22.04
      build_platforms:
      - linux/amd64

#############################################################################
# Release settings
#############################################################################
release:
  # Gist IDs for the JSON objects backing release badges
  badges:
    nightly:
      base_image:
        color: blue
        gist: "1fd45f442b8ab91bef6ef56423368128"
      version:
        color: orange
        gist: "9653c15d4e5b0413fb71397e643ab822"
    stable:
      base_image:
        color: blue
        gist: "6391e3a762e26c822281b1dbf2af5bd1"
      version:
        color: green
        gist: "2fda06b2047d0643d91308462197110a"
  # Base image for the pre-release image
  base_image: ubuntu:22.04
  # Build platforms for the pre-release and final images
  build_platforms:
  - linux/amd64
  - linux/arm64
  # Push pre-release image to GitHub for testing
  prerelease_repo: ghcr.io/mentalsmash/ref-project-debdocker-test
  # Image repositories for the released images.
  # Published to both GitHub and DockerHub
  release_repos:
  - ghcr.io/mentalsmash/ref-project-debdocker
  - mentalsmash/ref-project-debdocker
  # Add an arbitrary suffix to the image tags
  tag_suffix: ''
